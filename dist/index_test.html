<html>
  <head>
    <title>Scorecard Test</title>
    <link rel="stylesheet" type="text/css" href="xcard.css">
    <script type="text/javascript" src="xcard.js"></script>
    <script type="text/javascript" src="xcard-data.js"></script>
  </head>

  <body>
    <select id="chooseRound">
      <option>Choose Round</option>
    </select>

    <select id="bowType">
      <option value="recurve">Default Bow Type</option>
      <option value="compound">Compound</option>
    </select>

    <h2 id="date">Date ...... / ...... / ..........</h2>

    <h2 id="event">Event ..............................................................</h2>

    <table id="xcard-table">
      <thead></thead>

      <tbody></tbody>


    </table>

    <h2 id="archers-name">Archer's Signature ............................................................</h2>

    <h2 id="archers-name">Scorer's Signature ............................................................</h2>

    <ul>
      <li>RT = Row Total</li>
      <li>H = Hits</li>
      <li>G = Golds + X (or maximum score)</li>
      <li>W = Whites (specific rounds)</li>
      <li>X = X's (outdoor rounds only)</li>
      <li>P = Points (match rounds only)</li>
      <li>TOT = Running total score</li>
      <li>TOT PT = Running total points (match rounds only)</li>
    </ul>

    <script type="text/javascript">
      var mappedRounds = window.TARGET_ROUNDS.reduce(function(m, tR) {
        m[tR['short_name']] = tR
        return m;
      }, {});

      var selector = document.getElementById('chooseRound');
      for (var i in window.TARGET_ROUNDS) {
        var tRound = window.TARGET_ROUNDS[i];
        var option = document.createElement("option");
        option.value = tRound['short_name'];
        option.text = tRound['name'];
        selector.appendChild(option);
      }

      var buildTable = function(newRound, bowType) {
        html = "<thead></thead>"

        var tData = mappedRounds[newRound]
        var tRound = new XCard.TargetDataAdapter(tData, bowType);

        for (var i in tRound.distances) {
          var config = new XCard.DistanceConfig(tRound.distances[i]);
          var block = new XCard.DistanceBlock({config: config});
          html = html + block.toHtml().outerHTML;
        }

        var table = document.getElementById('xcard-table');
        table.innerHTML = html;
      };

      document.getElementById("chooseRound").addEventListener('change', function(event) {
        var newRound = event.target.value
        var bowType = document.getElementById('bowType').value
        if (newRound != '') {
          buildTable(newRound, bowType);
        }
      });

      document.getElementById("bowType").addEventListener('change', function(event) {
        var bowType = event.target.value
        var newRound = document.getElementById('chooseRound').value
        buildTable(newRound, bowType);
      });
    </script>

</html>
