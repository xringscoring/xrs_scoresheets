(function(){var t=this;(function(){(function(){this.XCard={VERSION:"0.0.1",config:{maxCellsPerRow:12,classPrefix:"xcard"}}}).call(this)}).call(t);var o=t.XCard;(function(){(function(){o.displayCell=function(t,n,i){var s;return null==i&&(i={}),s=Object.assign(i,{textContent:t,className:n}),new o.BasicCell(s)}}).call(this),function(){o.extend=function(t){var o,n;for(o in t)n=t[o],this[o]=n;return this}}.call(this),function(){o.extend({elementToString:function(t,n){var i;return null==n&&(n={}),i=o.makeElement(t,n),i.outerHTML},makeElement:function(t,o){var n,i,s,e,l,r,c,a,h,u;if(null==o&&(o={}),i=document.createElement(t),o.attributes){r=o.attributes;for(e in r)u=r[e],i.setAttribute(e,u)}if(o.style){c=o.style;for(e in c)u=c[e],i.style[e]=u}if(o.data){a=o.data;for(e in a)u=a[e],i.dataset[e]=u}if(o.className)for(h=o.className.split(" "),s=0,l=h.length;l>s;s++)n=h[s],i.classList.add(n);return o.textContent&&(i.textContent=o.textContent),o.colSpan&&i.setAttribute("colspan",o.colSpan),i}})}.call(this),function(){o.chunkArray=function(t,o){var n,i,s;if(0===t.length)return t;for(n=[],i=0,s=t.length;s>i;)n.push(t.slice(i,i+=o));return n}}.call(this),function(){o.extend({uniqueArray:function(t){var o,n,i,s;for(i={},n=0,s=t.length;s>n;n++)o=t[n],i[""+o+typeof o]=o;return Object.keys(i).map(function(t){return i[t]})}})}.call(this),function(){}.call(this),function(){o.DistanceBlock=function(){function t(t,n){var i;if(null==t&&(t={}),this.endsScoreData=null!=n?n:[],this.options=Object.assign({element:"tbody",config:null},t),null==this.options.config)throw"Distance configuration is required";this.config=this.options.config,this.totalizer=null!=(i=this.options.totalizer)?i:new o.Totalizer({config:this.config}),this.configureBlock()}return t.prototype.configureBlock=function(){var t,n,i;for(this.chunkedEndsScoreData=o.chunkArray(this.endsScoreData,this.config.endsPerRow),this.rows=[new o.DistanceHeaderRow({config:this.config})],n=t=0,i=this.config.rowCount-1;i>=0?i>=t:t>=i;n=i>=0?++t:--t)this.rows.push(new o.ScoringRow({rowIndex:n,config:this.config,totals:this.totalizer},this.chunkedEndsScoreData[n]));return this.config.isMatch()&&0!==this.config.distanceIndex?void 0:this.rows.push(new o.DistanceTotalsRow({config:this.config,totals:this.totalizer,cellSpan:this.config.titleCellSpan}))},t.prototype.toHtml=function(){var t,o,n,i,s;for(t=document.createElement(this.options.element),s=this.rows,o=0,n=s.length;n>o;o++)i=s[o],t.appendChild(i.toHtml());return t},t}()}.call(this),function(){o.BasicElement=function(){function t(t,o){null==t&&(t={}),this.element=null!=o?o:"td",this.attributes={},this.setAttributes(t)}return t.prototype.className=function(t){var n;return n=null!=t?t:this.constructor.name.toLowerCase(),o.config.classPrefix+"-"+n},t.prototype.setAttributes=function(t){return null==t&&(t={}),this.attributes=Object.assign(this.attributes,t)},t.prototype.toHtmlString=function(){return o.elementToString(this.element,this.ensureClassnames(this.attributes))},t.prototype.toHtml=function(){return o.makeElement(this.element,this.ensureClassnames(this.attributes))},t.prototype.ensureClassnames=function(t){var n,i;return null==t&&(t={}),n=null!=t.className?t.className.split(" "):[],i=o.uniqueArray(n).sort(),t.className=i.join(" "),t},t}()}.call(this),function(){var t=function(t,o){function i(){this.constructor=t}for(var s in o)n.call(o,s)&&(t[s]=o[s]);return i.prototype=o.prototype,t.prototype=new i,t.__super__=o.prototype,t},n={}.hasOwnProperty;o.BasicCell=function(o){function n(t){null==t&&(t={}),n.__super__.constructor.call(this,t,"td")}return t(n,o),n}(o.BasicElement)}.call(this),function(){o.BlockElement=function(){function t(t){if(null==t&&(t={}),this.options=Object.assign({config:null,totals:null},t),null==this.options.config)throw"BlockElement requires DistanceConfig";this.config=this.options.config,this.handlePadding()}return t.prototype.handlePadding=function(){var t,n,i,s;if(this.paddingCells=[],0!==this.config.leftPaddingCellCount){for(s=[],n=t=1,i=this.config.leftPaddingCellCount;i>=1?i>=t:t>=i;n=i>=1?++t:--t)s.push(this.paddingCells.push(new o.BasicCell({className:"padding-cell"})));return s}},t}()}.call(this),function(){o.DistanceConfig=function(){function t(t,o,n){null==t&&(t={}),null==o&&(o={}),null==n&&(n=null),this.options=Object.assign({distanceIndex:0,shotsPerEnd:6,title:"Distance",totalShots:36,withHits:!0,withGolds:!0,goldScore:10,goldsDescriptor:"g",withX:!0,recurveMatch:!1,compoundMatch:!1,withTotalHeaders:!0,titleCellSpan:null,leftPaddingCellCount:0},t),this.scoreData=o,this.distanceIndex=this.options.distanceIndex,this.goldScore=this.options.goldScore,this.leftPaddingCellCount=this.options.leftPaddingCellCount,this.shotsPerEnd=this.getShotsPerEnd(),this.totalShots=this.options.totalShots,this.title=this.options.title,this.withX=this.options.withX,this.withGolds=this.options.withGolds,this.goldScore=this.options.goldScore,this.goldsDescriptor=this.options.goldsDescriptor,this.withPoints=this.showPoints(),this.withHits=this.showHits(),this.withTotalHeaders=this.options.withTotalHeaders,this.totalsOrder=["t","h","g","x","rt","p","tp"],this.numberOfEnds=this.totalShots/this.shotsPerEnd,this.endsPerRow=this.getEndsPerRow(),this.rowCount=this.getRowCount(),this.cellsPerEnd=this.getCellsPerEnd(),this.endTotalCells=1===this.endsPerRow?0:this.endsPerRow}return t.prototype.getCellsPerEnd=function(){return this.isMatch()?3:this.shotsPerEnd<=3?3:5===this.shotsPerEnd?5:this.shotsPerEnd<=6?6:12},t.prototype.getEndsPerRow=function(){return this.isMatch()?1:this.shotsPerEnd<=6?2:1},t.prototype.getRowCount=function(){return this.isMatch()&&this.options.distanceIndex>0?3:Math.round(this.numberOfEnds/this.endsPerRow)},t.prototype.getShotsPerEnd=function(){return this.scoreData.shotsPerEnd||this.options.shotsPerEnd},t.prototype.isMatch=function(){return this.options.recurveMatch||this.options.compoundMatch},t.prototype.showHits=function(){return!(this.options.recurveMatch||this.options.compoundMatch)},t.prototype.showPoints=function(){return this.options.recurveMatch},t}()}.call(this),function(){var t=function(t,o){function i(){this.constructor=t}for(var s in o)n.call(o,s)&&(t[s]=o[s]);return i.prototype=o.prototype,t.prototype=new i,t.__super__=o.prototype,t},n={}.hasOwnProperty;o.DistanceHeaderRow=function(n){function i(t){var n,s,e,l,r;for(null==t&&(t={}),i.__super__.constructor.call(this,t),this.totalsFunctionMap={h:["getRowHitsCell",this.config.withHits],g:["getRowGoldsCell",this.config.withGolds],x:["getRowXCell",this.config.withX],p:["getRowPointsCell",this.config.withPoints],t:["getRowTotalCell",this.config.endsPerRow>1],rt:["getRunningTotalCell",!0],tp:["getRunningTotalPointsCell",this.config.withPoints]},this.cells=new o.DistanceTitleCells({config:this.config}).cells,l=this.config.totalsOrder,s=0,e=l.length;e>s;s++)r=l[s],n=this.totalsFunctionMap[r],n[1]&&this.cells.push(this[n[0]]())}var s;return t(i,n),s=o.displayCell,i.prototype.getRowGoldsCell=function(){return s(this.forDisplay(this.config.goldsDescriptor),"row-golds-cell")},i.prototype.getRowTotalCell=function(){return s(this.forDisplay("s"),"row-total-cell")},i.prototype.getRowHitsCell=function(){return s(this.forDisplay("h"),"row-hits-cell")},i.prototype.getRowPointsCell=function(){return s(this.forDisplay("pt"),"row-points-cell")},i.prototype.getRowXCell=function(){return s(this.forDisplay("x"),"row-x-cell")},i.prototype.getRunningTotalCell=function(){return s(this.forDisplay("tot"),"running-total-cell wide")},i.prototype.getRunningTotalPointsCell=function(){return s(this.forDisplay("tot pt"),"running-total-points-cell")},i.prototype.forDisplay=function(t){return this.options.config.withTotalHeaders?t:""},i.prototype.toHtmlString=function(){return this.toHtml().outerHTML},i.prototype.toHtml=function(){var t,n,i,s,e,l,r,c,a;for(n=new o.BasicElement({className:"header-row"},"tr").toHtml(),c=this.paddingCells,i=0,e=c.length;e>i;i++)r=c[i],n.appendChild(r.toHtml());for(a=this.cells.slice(0),s=0,l=a.length;l>s;s++)t=a[s],n.appendChild(t.toHtml());return n},i}(o.BlockElement)}.call(this),function(){o.DistanceTitleCells=function(){function t(t){null==t&&(t={}),this.options=Object.assign({config:null},t),this.config=this.options.config,this.endTotalCells=this.config.endTotalCells,this.cellSpan=this.getCellSpan(),this.cells=[n(this.config.title,"title-cell",{colSpan:this.cellSpan})],this.config.endTotalCells>=1&&this.cells.push(n("et","header-et-cell")),this.config.endsPerRow>1&&this.cells.push(n("","header-spacer-cell",{colSpan:this.cellSpan})),this.config.endTotalCells>1&&this.cells.push(n("et","header-et-cell"))}var n;return n=o.displayCell,t.prototype.getCellSpan=function(){return 1===this.config.endsPerRow?this.config.endsPerRow*this.config.cellsPerEnd:this.config.cellsPerEnd},t}()}.call(this),function(){var t=function(t,o){function i(){this.constructor=t}for(var s in o)n.call(o,s)&&(t[s]=o[s]);return i.prototype=o.prototype,t.prototype=new i,t.__super__=o.prototype,t},n={}.hasOwnProperty;o.DistanceTotalsRow=function(n){function i(t){null==t&&(t={}),i.__super__.constructor.call(this,t),this.cells=[this.getSpacerCell()],this.config.withHits&&this.cells.push(this.getRowHitsCell()),this.config.withGolds&&this.cells.push(this.getRowGoldsCell()),this.config.withX&&this.cells.push(this.getRowXCell()),this.cells.push(this.getRunningTotalCell()),this.config.withPoints&&this.cells.push(this.getRowPointsCell()),this.config.withPoints&&this.cells.push(this.getRunningTotalPointsCell())}var s;return t(i,n),s=o.displayCell,i.prototype.getCellSpan=function(){return 1===this.config.endsPerRow?this.config.cellsPerEnd:this.config.endsPerRow*this.config.cellsPerEnd+(this.config.endsPerRow+1)},i.prototype.getSpacerCell=function(){var t;return t=new o.BasicCell,t.setAttributes({colSpan:this.getCellSpan(),textContent:"",className:"totals-spacer"}),t},i.prototype.getRowGoldsCell=function(){return s(this.forDisplay(this.options.totals.totalGolds.toString()),"total-golds-cell")},i.prototype.getRowTotalCell=function(){return s("rt","row-total-cell")},i.prototype.getRowHitsCell=function(){return s(this.forDisplay(this.options.totals.totalHits.toString()),"total-hits-cell")},i.prototype.getRowPointsCell=function(){return s(this.forDisplay(""),"total-points-cell unused")},i.prototype.getRowXCell=function(){return s(this.forDisplay(this.options.totals.totalX.toString()),"total-x-cell")},i.prototype.getRunningTotalCell=function(){return s(this.forDisplay(this.options.totals.totalScore.toString()),"total-score-cell")},i.prototype.getRunningTotalPointsCell=function(){return s(this.forDisplay(this.options.totals.totalPoints.toString()),"total-points-cell")},i.prototype.forDisplay=function(t){return this.options.totals.totalScore>0?t:""},i.prototype.toHtml=function(){var t,n,i,s,e,l,r,c,a;for(n=new o.BasicElement({className:"totals-row"},"tr").toHtml(),c=this.paddingCells,i=0,e=c.length;e>i;i++)r=c[i],n.appendChild(r.toHtml());for(a=this.cells.slice(0),s=0,l=a.length;l>s;s++)t=a[s],n.appendChild(t.toHtml());return n},i}(o.BlockElement)}.call(this),function(){o.Scorecard=function(){function t(t){var n,i,s,e,l,r,c,a,h,u,p,f;for(null==t&&(t={}),this.options=Object.assign({tableElement:null,targetRoundDefinition:{},scoreData:{},bowType:"recurve"},t),u=new o.ScoreDataAdapter(this.options.scoreData),f=new o.TargetDataAdapter(this.options.targetRoundDefinition,this.options.bowType),this.totalizer=new o.Totalizer,this.distanceBlocks=[],r=f.distances,s=e=0,l=r.length;l>e;s=++e)p=r[s],h=null!=(c=u.distances[s])?c:{},i=new o.DistanceConfig(p,h),n=new o.DistanceBlock({config:i,totalizer:this.totalizer},null!=(a=h.distanceEnds)?a:[]),this.distanceBlocks.push(n)}return t.prototype.html=function(){var t,o,n,i,s;for(o="<thead></thead>",s=this.distanceBlocks,n=0,i=s.length;i>n;n++)t=s[n],o+=t.toHtml().outerHTML;return o},t}()}.call(this),function(){var t=function(t,o){function i(){this.constructor=t}for(var s in o)n.call(o,s)&&(t[s]=o[s]);return i.prototype=o.prototype,t.prototype=new i,t.__super__=o.prototype,t},n={}.hasOwnProperty;o.ScoreCell=function(o){function n(t,o){var i;this.scoreData=null!=t?t:{},this.unused=null!=o?o:!1,n.__super__.constructor.call(this),this.scoreValue=null!=this.scoreData.score?parseInt(this.scoreData.score,10):null,this.text=null!=(i=this.scoreData.text)?i:"",this.setAttributes({className:this.getClasses(),textContent:this.getTextContent(),data:{score:this.scoreValue}})}return t(n,o),n.prototype.getClasses=function(){var t;return t=["score-cell"],this.unused&&t.push("unused"),t.join(" ")},n.prototype.getTextContent=function(){return null==this.scoreValue?"":0===this.scoreValue?"m":null!=this.text?this.text:this.scoreValue},n.prototype.score=function(){var t;return null!=(t=this.scoreValue)?t:0},n}(o.BasicCell)}.call(this),function(){o.ScoringEnd=function(){function t(t){if(null==t&&(t={}),this.options=Object.assign({endInUse:!0,cellCount:3,scores:[],points:0,config:null},t),this.endInUse=this.options.endInUse,this.endTotalCell=null,null==this.options.config)throw"ScoringEnd requires DistanceConfig";this.build()}return t.prototype.build=function(){return this.buildScoringCells(),this.options.config.endsPerRow>1?this.buildEndTotalCell():void 0},t.prototype.buildScoringCells=function(){var t,n,i,s,e,l,r;for(this.scoringCells=[],e=[],t=n=1,i=this.options.cellCount;i>=1?i>=n:n>=i;t=i>=1?++n:--n)r=this.isUnusedCell(t),l=null!=(s=this.options.scores[t-1])?s:{},e.push(this.scoringCells.push(new o.ScoreCell(l,r)));return e},t.prototype.buildEndTotalCell=function(){return this.endTotalCell=new o.EndTotalCell({config:this.options.config,scoringCells:this.scoringCells,totalScore:this.totalScore(),hasAtLeastOneScore:this.hasAtLeastOneScore()})},t.prototype.cells=function(){var t;return t=this.scoringCells.slice(0),null!=this.endTotalCell&&t.push(this.endTotalCell),t},t.prototype.isUnusedCell=function(t){return this.endInUse?t>this.options.config.shotsPerEnd?!0:!1:!0},t.prototype.hasAtLeastOneScore=function(){return this.scoringCells.filter(function(t){return null!=t.scoreValue}).length>0},t.prototype.totalHits=function(){return this.scoringCells.filter(function(t){return t.score()>0}).length},t.prototype.totalGolds=function(){var t;return t=this,this.scoringCells.reduce(function(o,n){return o+(n.score()===t.options.config.goldScore?1:0)},0)},t.prototype.totalScore=function(){return this.scoringCells.reduce(function(t,o){return t+=o.score()},0)},t.prototype.totalX=function(){return this.scoringCells.filter(function(t){var o;return o=t.getTextContent(),"x"===o}).length},t.prototype.totalPoints=function(){return this.options.points},t}()}.call(this),function(){var t=function(t,o){function i(){this.constructor=t}for(var s in o)n.call(o,s)&&(t[s]=o[s]);return i.prototype=o.prototype,t.prototype=new i,t.__super__=o.prototype,t},n={}.hasOwnProperty;o.ScoringRow=function(n){function i(t,o){var n;null==t&&(t={}),this.endScoresData=null!=o?o:[],n=Object.assign({rowIndex:0,config:null,totals:null},t),i.__super__.constructor.call(this,n),this.buildScoringEnds(),this.buildTotalsBlock()}return t(i,n),i.prototype.buildScoringEnds=function(){var t,n,i,s,e,l,r,c,a;for(this.scoringEnds=[],l=[],t=n=1,i=this.config.endsPerRow;i>=1?i>=n:n>=i;t=i>=1?++n:--n)r=null!=(s=this.endScoresData[t-1])?s:{},c=this.orderedScores(null!=(e=r.shots)?e:[]),a=new o.ScoringEnd({endInUse:this.ensureEndInUse(t),config:this.config,cellCount:this.config.cellsPerEnd,scores:c,points:this.pointsForRow(r)}),l.push(this.scoringEnds.push(a));return l},i.prototype.buildTotalsBlock=function(){return this.totalsBlock=new o.ScoringRowTotals({config:this.config,scoringEnds:this.scoringEnds,totals:this.options.totals})},i.prototype.ensureEndInUse=function(t){return(this.options.rowIndex+1)*t<=this.config.numberOfEnds},i.prototype.orderedScores=function(t){return null==t&&(t=[]),t.slice(0).map(function(t){var o,n,i,s;return i=parseInt(null!=(o=t.score)?o:0,10),s=null!=(n=t.text)?n:"",t._tempScore=null!=s.toString().match(/x/i)?11:i,t}).sort(function(t,o){return o._tempScore-t._tempScore})},i.prototype.pointsForRow=function(t){var o,n;return o=parseInt(null!=(n=t.matchEndResult)?n:0,10),-1===o?0:o},i.prototype.toHtml=function(){var t,n,i,s,e,l,r,c,a,h,u,p,f,d,g,w,y;for(t=new o.BasicElement({className:"scoring-row"},"tr").toHtml(),u=this.paddingCells,n=0,e=u.length;e>n;n++)h=u[n],t.appendChild(h.toHtml());for(p=this.scoringEnds,i=0,l=p.length;l>i;i++)for(y=p[i],f=y.cells(),s=0,r=f.length;r>s;s++)w=f[s],t.appendChild(w.toHtml());for(d=this.totalsBlock.cells,a=0,c=d.length;c>a;a++)g=d[a],t.appendChild(g.toHtml());return t},i}(o.BlockElement)}.call(this),function(){o.ScoringRowTotals=function(){function t(t){if(null==t&&(t={}),this.options=Object.assign({config:null,scoringEnds:[],totals:null},t),null==this.options.config)throw"ScoringRow totals requires DistanceConfig";this.config=this.options.config,this.scoringEnds=this.options.scoringEnds,this.displayTotals=this.ensureAtLeastOneScoringEnd(),this.totalsFunctionMap={h:["getRowHitsCell",this.config.withHits],g:["getRowGoldsCell",this.config.withGolds],x:["getRowXCell",this.config.withX],p:["getRowPointsCell",this.config.withPoints],t:["getRowTotalCell",this.scoringEnds.length>1],rt:["getRunningTotalCell",!0],tp:["getRunningTotalPointsCell",this.config.withPoints]},this.buildTotals()}var n;return n=o.displayCell,t.prototype.buildTotals=function(){var t,o,n,i,s,e;for(this.rowTotalPoints=0,this.rowTotalScore=this.getRowTotalScore(),this.options.totals.totalScore+=this.rowTotalScore,this.rowTotalHits=this.getRowTotalHits(),this.options.totals.totalHits+=this.rowTotalHits,this.rowTotalGolds=this.getRowTotalGolds(),this.options.totals.totalGolds+=this.rowTotalGolds,this.rowTotalX=this.getRowTotalX(),this.options.totals.totalX+=this.rowTotalX,this.config.withPoints&&(this.rowTotalPoints=this.getRowTotalPoints(),this.options.totals.totalPoints+=this.rowTotalPoints),this.cells=[],i=this.config.totalsOrder,s=[],o=0,n=i.length;n>o;o++)e=i[o],t=this.totalsFunctionMap[e],s.push(t[1]?this.cells.push(this[t[0]]()):void 0);return s},t.prototype.getRowTotalCell=function(){return n(this.forDisplay(this.rowTotalScore),"row-total-score row-totals")},t.prototype.getRowHitsCell=function(){return n(this.forDisplay(this.rowTotalHits),"row-hits-total row-totals")},t.prototype.getRowGoldsCell=function(){return n(this.forDisplay(this.rowTotalGolds),"row-golds-total row-totals")},t.prototype.getRowXCell=function(){return n(this.forDisplay(this.rowTotalX),"row-x-total row-totals")},t.prototype.getRowPointsCell=function(){return n(this.forDisplay(this.rowTotalPoints),"row-points-total row-totals")},t.prototype.getRunningTotalCell=function(){return n(this.forDisplay(this.options.totals.totalScore),"row-running-total row-totals")},t.prototype.getRunningTotalPointsCell=function(){return n(this.forDisplay(this.options.totals.totalPoints),"row-running-total-points row-totals")},t.prototype.cells=function(){return this.cells},t.prototype.ensureAtLeastOneScoringEnd=function(){return this.scoringEnds.filter(function(t){return t.hasAtLeastOneScore()}).length>0},t.prototype.forDisplay=function(t){return this.displayTotals?t.toString():""},t.prototype.getRowTotalGolds=function(){return this.scoringEnds.reduce(function(t,o){return t+o.totalGolds()},0)},t.prototype.getRowTotalX=function(){return this.scoringEnds.reduce(function(t,o){return t+o.totalX()},0)},t.prototype.getRowTotalHits=function(){return this.scoringEnds.reduce(function(t,o){return t+o.totalHits()},0)},t.prototype.getRowTotalPoints=function(){return this.scoringEnds.reduce(function(t,o){return t+o.totalPoints()},0)},t.prototype.getRowTotalScore=function(){return this.scoringEnds.reduce(function(t,o){return t+o.totalScore()},0)},t}()}.call(this),function(){var t=function(t,o){function i(){this.constructor=t}for(var s in o)n.call(o,s)&&(t[s]=o[s]);return i.prototype=o.prototype,t.prototype=new i,t.__super__=o.prototype,t},n={}.hasOwnProperty;o.EndTotalCell=function(o){function n(t){var o,i;if(this.options=null!=t?t:{},null==this.options.config)throw"EndTotalCell requires DistanceConfig";this.totalScore=null!=(o=this.options.totalScore)?o:0,this.scoringCells=null!=(i=this.options.scoringCells)?i:[],n.__super__.constructor.call(this,{className:"end-total-cell row-totals",textContent:this.textContent()})}return t(n,o),n.prototype.textContent=function(){return this.options.hasAtLeastOneScore?this.totalScore.toString():""},n}(o.BasicCell)}.call(this),function(){o.Totalizer=function(){function t(t){null==t&&(t={}),this.totalHits=this.totalScore=this.totalPoints=this.totalGolds=this.totalX=0}return t}()}.call(this),function(){}.call(this),function(){o.ScoreDataAdapter=function(){function t(t){this.scoreData=null!=t?t:{},this.parseData()}return t.prototype.parseData=function(){var t;return this.distances=null!=(t=this.scoreData.distances)?t:[]},t.prototype.distances=function(){return this.distances},t}()}.call(this),function(){o.TargetDataAdapter=function(){function t(t,o){if(this.targetRoundDefinition=t,this.bowType=null!=o?o:"recurve",null==this.targetRoundDefinition)throw"Target Round definition is required";this.parseRoundDefinition(),this.ensureLeftPadding()}return t.prototype.ensureLeftPadding=function(){var t,o,n,i,s,e;if(!this.isMatchRound()){for(s=this.distances,e=[],o=n=0,i=s.length;i>n;o=++n)t=s[o],e.push(this.distances[o].leftPaddingCellCount=2*(this.maxShotsPerEnd-t.shotsPerEnd));return e}},t.prototype.parseRoundDefinition=function(){var t,o,n,i,s,e,l;for(this.distances=[],this.maxShotsPerEnd=0,this.totalShots=0,this.scoringScheme=this.targetRoundDefinition.scoring_scheme,e=this.targetRoundDefinition.distances,l=[],n=i=0,s=e.length;s>i;n=++i)t=e[n],o=this.distanceDefinition(t,n),this.distances.push(o),this.maxShotsPerEnd=o.shotsPerEnd>this.maxShotsPerEnd?o.shotsPerEnd:this.maxShotsPerEnd,l.push(this.totalShots+=o.totalShots);return l},t.prototype.distanceDefinition=function(t,o){var n;return{distanceIndex:o,shotsPerEnd:this.toNumber(null!=(n=t.shots_per_end)?n:this.targetRoundDefinition.default_shots_per_end),title:this.title(t.range,o),totalShots:this.toNumber(t.total_shots),withHits:!0,withGolds:!0,goldScore:this.toNumber(this.targetRoundDefinition.scoring_scheme[0]),goldsDescriptor:this.goldsDescriptor(),withX:this.withX(),recurveMatch:this.isRecurveMatchRound(),compoundMatch:this.isCompoundMatchRound(),withTotalHeaders:this.withTotalHeaders(o)}},t.prototype.goldsDescriptor=function(){return this.targetRoundDefinition.short_name.match(/worcester|nfaa_300/i)?"w":"g"},t.prototype.isCompoundMatchRound=function(){return"compound"!==this.bowType?!1:this.isMatchRound()},t.prototype.isRecurveMatchRound=function(){return"compound"===this.bowType?!1:this.isMatchRound()},t.prototype.isMatchRound=function(){return this.targetRoundDefinition.short_name.match(/match/)},t.prototype.rangeUnit=function(){return"metric"===this.targetRoundDefinition.round_type?"m":"yd"},t.prototype.title=function(t,o){return this.isMatchRound()&&o>0?"Tie-break":""+t+this.rangeUnit()},t.prototype.toNumber=function(t){return parseInt(t,10)},t.prototype.withTotalHeaders=function(){return!0},t.prototype.withX=function(){return"outdoor"===this.targetRoundDefinition.environment&&this.targetRoundDefinition.has_x},t}()}.call(this),function(){}.call(this),function(){}.call(this)}).call(this),"object"==typeof module&&module.exports?module.exports=o:"function"==typeof define&&define.amd&&define(o)}).call(this);