(function(){var t=this;(function(){(function(){this.XCard={VERSION:"0.0.1",config:{maxCellsPerRow:12,classPrefix:"xcard"}}}).call(this)}).call(t);var s=t.XCard;(function(){(function(){s.extend=function(t){var s,e;for(s in t)e=t[s],this[s]=e;return this}}).call(this),function(){s.extend({elementToString:function(t,e){var n;return null==e&&(e={}),n=s.makeElement(t,e),n.outerHTML},makeElement:function(t,s){var e,n,o,i,l,r,c,u,h,a;if(null==s&&(s={}),n=document.createElement(t),s.attributes){r=s.attributes;for(i in r)a=r[i],n.setAttribute(i,a)}if(s.style){c=s.style;for(i in c)a=c[i],n.style[i]=a}if(s.data){u=s.data;for(i in u)a=u[i],n.dataset[i]=a}if(s.className)for(h=s.className.split(" "),o=0,l=h.length;l>o;o++)e=h[o],n.classList.add(e);return s.textContent&&(n.textContent=s.textContent),s.colSpan&&n.setAttribute("colspan",s.colSpan),n}})}.call(this),function(){s.extend({uniqueArray:function(t){var s,e,n,o;for(n={},e=0,o=t.length;o>e;e++)s=t[e],n[""+s+typeof s]=s;return Object.keys(n).map(function(t){return n[t]})}})}.call(this),function(){}.call(this),function(){s.DistanceBlock=function(){function t(t){null==t&&(t={}),this.options=Object.assign({shotsPerEnd:6,title:"1",totalShots:36,withGolds:!0,withHits:!0,withPoints:!1,withX:!1},t),this.configureBlock()}return t.prototype.configureBlock=function(){return this.shotsPerEnd=this.options.shotsPerEnd,this.totalShots=this.options.totalShots,this.numberOfEnds=this.totalShots/this.shotsPerEnd,this.endsPerRow=this.getEndsPerRow(),this.cellsPerEnd=this.getCellsPerEnd(),this.rowCount=this.numberOfEnds/this.endsPerRow,this.endTotalCells=this.endsPerRow,this.withHits=this.options.withHits,this.withGolds=this.options.withGolds,this.withPoints=this.options.withPoints,this.withX=this.options.withX,this.titleCellSpan=this.getTitleCellSpan(),this.rows=[new s.HeaderRow({title:this.options.title,titleCellSpan:this.titleCellSpan})]},t.prototype.getCellsPerEnd=function(){return this.shotsPerEnd<=3?3:this.shotsPerEnd<=6?6:12},t.prototype.getEndsPerRow=function(){return this.shotsPerEnd<=6?2:1},t.prototype.getTitleCellSpan=function(){return this.endsPerRow*this.cellsPerEnd+(this.endTotalCells-1)},t}()}.call(this),function(){s.BasicElement=function(){function t(t,s){null==t&&(t={}),this.element=null!=s?s:"td",this.attributes={},this.setAttributes(t)}return t.prototype.className=function(t){var e;return e=null!=t?t:this.constructor.name.toLowerCase(),s.config.classPrefix+"-"+e},t.prototype.setAttributes=function(t){return null==t&&(t={}),this.attributes=Object.assign(this.attributes,t)},t.prototype.toHtmlString=function(){return s.elementToString(this.element,this.ensureClassnames(this.attributes))},t.prototype.toHtml=function(){return s.makeElement(this.element,this.ensureClassnames(this.attributes))},t.prototype.ensureClassnames=function(t){var e,n;return null==t&&(t={}),e=null!=t.className?t.className.split(" "):[],n=s.uniqueArray(e).sort(),t.className=n.join(" "),t},t}()}.call(this),function(){s.BasicDistanceRow=function(){function t(t,s){this.shotsPerEnd=t,null==s&&(s={}),this.options=Object.assign({withHits:!0,withGolds:!0,withPoints:!1,withX:!1,goldsDescriptor:"g",hitsDescriptor:"h",xDescriptor:"x"},s),this.buildCells()}return t.prototype.buildCells=function(){var t,e,n,o,i,l,r,c;for(this.cells=[],r=this.getScoringCellsPerRow(),t=this.getEndsPerRow(),c=e=1,o=r/t;o>=1?o>=e:e>=o;c=o>=1?++e:--e){for(l=n=1,i=t;i>=1?i>=n:n>=i;l=i>=1?++n:--n)this.cells.push(new s.ScoreCell);this.cells.push(new s.EndTotalCell)}return this.renderHits()&&this.cells.push(new s.BasicCell({classes:["xcard-hits"]})),this.renderGolds()&&this.cells.push(new s.BasicCell({classes:["xcard-golds"]})),this.renderX()&&this.cells.push(new s.BasicCell({classes:["xcard-x"]})),this.cells.push(new s.BasicCell({classes:["xcard-row-total"]})),this.cells.push(new s.BasicCell({classes:["xcard-round-total"]}))},t.prototype.getCells=function(){return this.cells},t.prototype.getScoringCellsPerRow=function(){return this.shotsPerEnd<=3?6:12},t.prototype.getEndsPerRow=function(){return this.shotsPerEnd<=3?3:this.shotsPerEnd<=6?6:12},t.prototype.goldsDescriptor=function(){return this.options.goldsDescriptor},t.prototype.renderHits=function(){return this.options.withHits},t.prototype.renderGolds=function(){return this.options.withGolds},t.prototype.renderX=function(){return this.options.withX},t}()}.call(this),function(){var t=function(t,s){function n(){this.constructor=t}for(var o in s)e.call(s,o)&&(t[o]=s[o]);return n.prototype=s.prototype,t.prototype=new n,t.__super__=s.prototype,t},e={}.hasOwnProperty;s.BasicCell=function(s){function e(t){null==t&&(t={}),e.__super__.constructor.call(this,t,"td")}return t(e,s),e}(s.BasicElement)}.call(this),function(){s.HeaderRow=function(){function t(t){null==t&&(t={}),this.options=Object.assign({withGolds:!0,withHits:!0,withPoints:!1,withX:!1,title:"1",titleCellSpan:1},t),this.cells=[this.getTitleCell(),this.getRowTotalCell()],this.options.withPoints&&this.cells.push(this.getRowPointsCell()),this.options.withHits&&this.cells.push(this.getRowHitsCell()),this.options.withGolds&&this.cells.push(this.getRowGoldsCell()),this.options.withX&&this.cells.push(this.getRowXCell()),this.cells.push(this.getRunningTotalCell())}return t.prototype.getTitleCell=function(){var t;return t=new s.BasicCell,t.setAttributes({colSpan:this.options.titleCellSpan,textContent:this.options.title,className:"title-cell"}),t},t.prototype.getEndTotalCell=function(){var t;return t=new s.BasicCell,t.setAttributes({className:"end-total-cell"}),t},t.prototype.getRowGoldsCell=function(){var t;return t=new s.BasicCell,t.setAttributes({textContent:"g",className:"row-golds-cell"}),t},t.prototype.getRowTotalCell=function(){var t;return t=new s.BasicCell,t.setAttributes({textContent:"rt",className:"row-total-cell"}),t},t.prototype.getRowHitsCell=function(){var t;return t=new s.BasicCell,t.setAttributes({textContent:"h",className:"row-hits-cell"}),t},t.prototype.getRowPointsCell=function(){var t;return t=new s.BasicCell,t.setAttributes({textContent:"pt",className:"row-points-cell"}),t},t.prototype.getRowXCell=function(){var t;return t=new s.BasicCell,t.setAttributes({textContent:"x",className:"row-x-cell"}),t},t.prototype.getRunningTotalCell=function(){var t;return t=new s.BasicCell,t.setAttributes({textContent:"tot",className:"running-total-cell"}),t},t.prototype.toHtmlString=function(){return this.toHtml().outerHTML},t.prototype.toHtml=function(){var t,e,n,o,i;for(e=new s.BasicElement({className:"header-row"},"tr").toHtml(),i=this.cells.slice(0),n=0,o=i.length;o>n;n++)t=i[n],e.appendChild(t.toHtml());return e},t}()}.call(this),function(){var t=function(t,s){function n(){this.constructor=t}for(var o in s)e.call(s,o)&&(t[o]=s[o]);return n.prototype=s.prototype,t.prototype=new n,t.__super__=s.prototype,t},e={}.hasOwnProperty;s.ScoreCell=function(s){function e(t,s){var n,o;this.scoreData=null!=t?t:{},this.unused=null!=s?s:!1,e.__super__.constructor.call(this),this.scoreValue=null!=this.scoreData.score?parseInt(this.scoreData.score,10):null,this.isX=null!=(n=this.scoreData.isX)?n:!1,this.isGold=null!=(o=this.scoreData.isGold)?o:!1,this.text=this.scoreData.text,this.setAttributes({className:this.getClasses(),textContent:this.getTextContent(),data:{score:this.scoreValue}})}return t(e,s),e.prototype.getClasses=function(){var t;return t=["score-cell"],this.unused&&t.push("unused"),t.join(" ")},e.prototype.getTextContent=function(){return null==this.scoreValue?" ":0===this.scoreValue?"m":null!=this.text?this.text:this.scoreValue},e.prototype.score=function(){var t;return null!=(t=this.scoreValue)?t:0},e}(s.BasicCell)}.call(this),function(){s.ScoringEnd=function(){function t(t){null==t&&(t={}),this.options=Object.assign({cellCount:3,scores:[],shotsPerEnd:3},t),this.build()}return t.prototype.build=function(){return this.buildScoringCells(),this.buildEndTotalCell()},t.prototype.buildScoringCells=function(){var t,e,n,o,i,l,r;for(this.scoringCells=[],i=[],t=e=1,n=this.options.cellCount;n>=1?n>=e:e>=n;t=n>=1?++e:--e)r=t>this.options.shotsPerEnd?!0:!1,l=null!=(o=this.options.scores[t-1])?o:{},i.push(this.scoringCells.push(new s.ScoreCell(l,r)));return i},t.prototype.buildEndTotalCell=function(){return this.endTotalCell=new s.EndTotalCell({scoringCells:this.scoringCells})},t.prototype.cells=function(){var t;return t=this.scoringCells.slice(0),t.push(this.endTotalCell),t},t.prototype.totalHits=function(){return this.scoringCells.filter(function(t){return t.score()>0}).length},t.prototype.totalScore=function(){return this.endTotalCell.totalScore()},t}()}.call(this),function(){s.ScoringRow=function(){function t(t,s){null==t&&(t={}),this.endScoresData=null!=s?s:[],this.options=Object.assign({cellCount:3,element:"tr",endCount:1,shotsPerEnd:3,withX:!1,withGolds:!1,withHits:!1,withPoints:!1},t),this.buildScoringEnds(),this.buildTotalsBlock()}return t.prototype.buildScoringEnds=function(){var t,e,n,o,i;for(this.scoringEnds=[],o=[],t=e=1,n=this.options.endCount;n>=1?n>=e:e>=n;t=n>=1?++e:--e)i=new s.ScoringEnd({cellCount:this.options.cellCount,shotsPerEnd:this.options.shotsPerEnd,scores:this.endScoresData[t-1].shots}),o.push(this.scoringEnds.push(i));return o},t.prototype.buildTotalsBlock=function(){return this.totalsBlock=new s.ScoringRowTotals({withX:this.options.withX,withGolds:this.options.withGolds,withHits:this.options.withHits,withPoints:this.options.withPoints,scoringEnds:this.scoringEnds})},t.prototype.toHTML=function(){var t,e,n,o,i,l,r,c,u,h,a,p,d;for(t=s.makeElement(this.options.element,{className:"scoring-row"}),c=this.scoringEnds,e=0,i=c.length;i>e;e++)for(d=c[e],u=d.cells(),n=0,l=u.length;l>n;n++)p=u[n],t.appendChild(p.toHtml());for(h=this.totalsBlock.cells,o=0,r=h.length;r>o;o++)a=h[o],t.appendChild(a.toHtml());return t.outerHTML},t}()}.call(this),function(){s.ScoringRowTotals=function(){function t(t){null==t&&(t={}),this.options=Object.assign({withHits:!1,withGolds:!1,withPoints:!1,withX:!1,scoringEnds:[]},t),this.scoringEnds=this.options.scoringEnds,this.buildTotals()}return t.prototype.buildTotals=function(){return this.cells=[new s.BasicCell({className:"row-total-score",textContent:this.getRowTotalScore().toString()})],this.options.withHits&&this.cells.push(new s.BasicCell({className:"row-hits-total",textContent:this.getRowTotalHits().toString()})),this.options.withGolds&&this.cells.push(new s.BasicCell({className:"row-golds-total",textContent:this.getRowTotalGolds().toString()})),this.options.withX&&this.cells.push(new s.BasicCell({className:"row-x-total",textContent:this.getRowTotalX().toString()})),this.cells.push(new s.BasicCell({className:"row-running-total",textContent:"rt"}))},t.prototype.cells=function(){return this.cells},t.prototype.getRowTotalGolds=function(){return this.scoringEnds.reduce(function(t,s){return t+s.endTotalCell.totalGolds()},0)},t.prototype.getRowTotalHits=function(){return this.scoringEnds.reduce(function(t,s){return t+s.totalHits()},0)},t.prototype.getRowTotalScore=function(){return this.scoringEnds.reduce(function(t,s){return t+s.totalScore()},0)},t}()}.call(this),function(){var t=function(t,s){function n(){this.constructor=t}for(var o in s)e.call(s,o)&&(t[o]=s[o]);return n.prototype=s.prototype,t.prototype=new n,t.__super__=s.prototype,t},e={}.hasOwnProperty;s.EndTotalCell=function(s){function e(t){var s;this.options=null!=t?t:{},this.scoringCells=null!=(s=this.options.scoringCells)?s:[],e.__super__.constructor.call(this,{className:"end-total-cell",textContent:this.textContent()})}return t(e,s),e.prototype.cellsInUse=function(){return this.scoringCells.filter(function(t){return!t.unused})},e.prototype.endIsScored=function(){var t;return t=this.scoringCells.filter(function(t){return null!=t.scoreValue}),t.length===this.cellsInUse().length},e.prototype.textContent=function(){return this.endIsScored()?this.totalScore().toString():""},e.prototype.totalGolds=function(){return this.scoringCells.reduce(function(t,s){return t+(s.isGold?1:0)},0)},e.prototype.totalScore=function(){return this.scoringCells.reduce(function(t,s){return t+s.score()},0)},e}(s.BasicCell)}.call(this),function(){}.call(this),function(){}.call(this)}).call(this),"object"==typeof module&&module.exports?module.exports=s:"function"==typeof define&&define.amd&&define(s)}).call(this);